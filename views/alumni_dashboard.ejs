<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alumni Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <style>
    :root { --stumni-dark-blue: #0A2540; --stumni-gold: #FFC107; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8f9fa; }
    .sidebar { min-height: 100vh; background-color: var(--stumni-dark-blue); color: white; }
    .sidebar .nav-link { color: white; font-weight: 500; }
    .sidebar .nav-link:hover, .sidebar .nav-link.active { background-color: var(--stumni-gold); color: var(--stumni-dark-blue); border-radius: 5px; }
    .content { padding: 2rem; }
    .section { display: none; animation: fadeIn 0.5s; }
    .section.active { display: block; }
    .profile-pic { width: 150px; height: 150px; object-fit: cover; border: 4px solid var(--stumni-gold); }
  </style>
</head>
<body>
<div class="container-fluid">
  <div class="row">
    <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse p-3">
      <h3 class="text-center mb-4">Alumni Panel</h3>
      <ul class="nav flex-column">
        <li class="nav-item"><a class="nav-link active" href="#" data-target="overview"><i class="bi bi-person-circle me-2"></i> My Profile</a></li>
        <li class="nav-item"><a class="nav-link" href="#" data-target="requests"><i class="bi bi-person-plus me-2"></i> Requests</a></li>
        <li class="nav-item"><a class="nav-link" href="#" data-target="events"><i class="bi bi-calendar-event me-2"></i> Events</a></li>
        <li class="nav-item mt-auto"><a class="nav-link" href="/"><i class="bi bi-box-arrow-left me-2"></i> Logout</a></li>
      </ul>
    </nav>
    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 content">
      <h2 class="border-bottom pb-2 mb-4">Hello, <%= user.username %> ðŸ‘‹</h2>
      <% if(notifications && notifications.length > 0) { %>
          <div class="alert alert-info" role="alert">
            <h5 class="alert-heading">New Notifications</h5>
            <% notifications.forEach(notif => { %>
                <p class="mb-1"><i class="bi bi-bell-fill me-2"></i><%= notif.message %></p>
            <% }); %>
          </div>
      <% } %>
      <div id="overview" class="section active text-center">
        <img src="<%= user.profilePicture %>" class="profile-pic rounded-circle mb-3" alt="Profile Picture">
        <h2 class="fw-bold"><%= user.username %></h2>
        <p class="text-muted"><%= user.email %></p>
        <hr class="w-50 mx-auto">
        <p class="mb-1"><strong>Works as:</strong> <%= user.currentJob.title %> at <strong><%= user.currentJob.company %></strong></p>
        <p><strong>Alma Mater:</strong> <%= user.almaMater %></p>
      </div>
      <div id="requests" class="section">
          <h2>Mentorship Requests</h2>
          <hr>
          <% if (requests && requests.length > 0) { %>
              <% requests.forEach(req => { %>
                  <div class="card mb-3">
                      <div class="card-body d-flex justify-content-between align-items-center">
                          <div>
                              <strong><%= req.mentee.username %></strong> wants to connect.
                              <small class="d-block text-muted">Course: <%= req.mentee.course %></small>
                          </div>
                          <div>
                              <form action="/alumni/request-accept/<%= req._id %>/<%= user._id %>" method="POST" class="d-inline">
                                  <button class="btn btn-success btn-sm">Accept</button>
                              </form>
                          </div>
                      </div>
                  </div>
              <% }); %>
          <% } else { %>
              <p class="text-muted">You have no pending mentorship requests.</p>
          <% } %>
      </div>
      <div id="events" class="section">
        <h2>Upcoming Events</h2>
        <hr>
        <% if (events && events.length > 0) { %>
            <% events.forEach(event => { %>
              <div class="card mb-3">
                <div class="row g-0">
                  <div class="col-md-3 d-flex flex-column justify-content-center align-items-center text-white p-3" style="background-color: var(--stumni-dark-blue);">
                    <span class="fs-1 fw-bold"><%= new Date(event.date).getDate() %></span>
                    <span class="fs-5 text-uppercase"><%= new Date(event.date).toLocaleString('default', { month: 'short' }) %></span>
                  </div>
                  <div class="col-md-9">
                    <div class="card-body">
                      <h5 class="card-title"><%= event.name %></h5>
                      <p class="card-text mb-1"><small class="text-muted"><strong>Hosted by:</strong> <%= event.hostedBy %></small></p>
                      <p class="card-text"><small class="text-muted"><strong>Venue:</strong> <%= event.venue %></small></p>
                    </div>
                  </div>
                </div>
              </div>
            <% }); %>
        <% } else { %>
            <p class="text-muted">No upcoming events.</p>
        <% } %>
      </div>
    </main>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
    const sidebarLinks = document.querySelectorAll('.sidebar .nav-link[data-target]');
    sidebarLinks.forEach(link => {
      link.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelectorAll('.sidebar .nav-link').forEach(el => el.classList.remove('active'));
        this.classList.add('active');
        document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
        const targetId = this.getAttribute('data-target');
        document.getElementById(targetId).classList.add('active');
      });
    });
  });
</script>
</body>
</html>